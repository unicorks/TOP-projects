<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock Paper Scissors!</title>
</head>
<body>
<div id="body1" style="display:block">
    <h1>Play a game of rock, paper and scissors against the computer!</h1>
    <p>Press R for rock, P for paper and S for scissors.</p>
    <table>
        <tr>
        <th>YOU</th>
        <th>COMPUTER</th>
        </tr>
        <tr>
            <td id="player-score">Score: 0</td>
            <td id="comp-score">Score: 0</td>
        </tr>
        <tr>
            <td rowspan="2">
                <button id="rock">R</button>
                <button id="paper">P</button>
                <button id="scissors">S</button>
            </td>
        </tr>
        <tr>
            <td rowspan="2" id="result">The round's result will show up here.</td>
        </tr>
    </table>
</div>

<div id="body2" style="display:none">
    <h1 id="game-result"></h1>
    <button onclick="location.href = 'index.html'">Play again</button>
</div>
</body>

<script>
    function computerPlay() {
        choices = ["rock", "paper", "scissors"]
        return choices[Math.floor(Math.random() * choices.length)]
    }

    function rpsRound(playerSelect) {
        compSelect = computerPlay()
        if (playerSelect === compSelect) {
            return ("The round resulted in a draw.")
        }
        else if ((playerSelect === 'rock' && compSelect === 'scissors') || (playerSelect === 'paper' && compSelect === 'rock') || (playerSelect === 'scissors' && compSelect === 'paper')) {
            return (`The computer chose: ${compSelect}. You won!`)
        } 
        else {
            return (`The computer chose: ${compSelect}. You lost.`)
        }
    }

    window.addEventListener('load', function(){
        let buttons = document.querySelectorAll("button")
        let compScore = 0;
        let playerScore = 0;
        let rounds = 0;
        for (i = 0; i < buttons.length; i++) {
            buttons[i].addEventListener("click", function() {
                document.querySelector("#result").innerHTML = rpsRound(this.id);
                if (document.querySelector("#result").innerHTML.includes("lost")) {
                    compScore++
                    document.querySelector('#comp-score').innerHTML = `Score: ${compScore}`
                }
                else if (document.querySelector("#result").innerHTML.includes("won")) {
                    playerScore++
                    document.querySelector('#player-score').innerHTML = `Score: ${playerScore}`
                }

                if (rounds === 5) {
                document.querySelector('#body1').style.display = 'none'
                document.querySelector('#body2').style.display = 'block'
                if (compScore > playerScore) {
                    document.querySelector("#game-result").innerHTML = `The computer won with ${compScore} points. Your final score was ${playerScore}.`
                }
                else if (compScore < playerScore) {
                    document.querySelector("#game-result").innerHTML = `You won with ${playerScore} points. The computer's final score was ${compScore}.`
                }
                else {
                    document.querySelector("#game-result").innerHTML = 'The game resulted in a draw.'
                }
            }
                rounds++
            })
        }
    })
</script>
</html>